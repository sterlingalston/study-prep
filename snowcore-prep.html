<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SnowPro Core Certification Flashcards</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #29b6f6, #1976d2);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #1976d2;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
        }

        .controls {
            padding: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 1px solid #e9ecef;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .btn-primary {
            background: #1976d2;
            color: white;
        }

        .btn-primary:hover {
            background: #1565c0;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .domain-filter {
            padding: 15px 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .domain-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .domain-btn {
            padding: 8px 16px;
            border: 2px solid #1976d2;
            background: white;
            color: #1976d2;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85em;
        }

        .domain-btn.active {
            background: #1976d2;
            color: white;
        }

        .card-container {
            padding: 40px;
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card {
            width: 100%;
            max-width: 600px;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #1976d2;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .question-number {
            background: #1976d2;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .domain-tag {
            background: #e3f2fd;
            color: #1976d2;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .question-text {
            font-size: 1.2em;
            line-height: 1.6;
            margin-bottom: 25px;
            color: #333;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }

        .option {
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .option:hover {
            border-color: #1976d2;
            background: #f8f9ff;
        }

        .option.selected {
            border-color: #1976d2;
            background: #e3f2fd;
        }

        .option.correct {
            border-color: #28a745;
            background: #d4edda;
            color: #155724;
        }

        .option.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
            color: #721c24;
        }

        .explanation {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #17a2b8;
        }

        .explanation h4 {
            color: #17a2b8;
            margin-bottom: 10px;
        }

        .card-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        .progress-bar {
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            margin: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #28a745, #20c997);
            transition: width 0.3s ease;
        }

        .completion-screen {
            text-align: center;
            padding: 50px 30px;
        }

        .completion-screen h2 {
            color: #28a745;
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        .completion-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .completion-stat {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #28a745;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .card-container {
                padding: 20px;
            }
            
            .stats {
                flex-direction: column;
                gap: 15px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .domain-buttons {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>❄️ SnowPro Core Certification</h1>
            <p>Master Snowflake concepts with interactive flashcards</p>
        </div>

        <div class="stats">
            <div class="stat">
                <div class="stat-number" id="currentQuestion">1</div>
                <div class="stat-label">Current</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="totalQuestions">75</div>
                <div class="stat-label">Total</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="correctAnswers">0</div>
                <div class="stat-label">Correct</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="accuracy">0%</div>
                <div class="stat-label">Accuracy</div>
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="startQuiz()">Start Quiz</button>
            <button class="btn btn-secondary" onclick="shuffleQuestions()">Shuffle</button>
            <button class="btn btn-secondary" onclick="resetQuiz()">Reset</button>
        </div>

        <div class="domain-filter">
            <div class="domain-buttons">
                <button class="domain-btn active" onclick="filterDomain('all')">All Domains</button>
                <button class="domain-btn" onclick="filterDomain('architecture')">Architecture</button>
                <button class="domain-btn" onclick="filterDomain('security')">Security</button>
                <button class="domain-btn" onclick="filterDomain('performance')">Performance</button>
                <button class="domain-btn" onclick="filterDomain('loading')">Data Loading</button>
                <button class="domain-btn" onclick="filterDomain('transformation')">Transformation</button>
                <button class="domain-btn" onclick="filterDomain('protection')">Protection</button>
            </div>
        </div>

        <div class="card-container" id="cardContainer">
            <div class="card" id="questionCard">
                <div class="question-header">
                    <span class="question-number" id="questionNumber">Question 1</span>
                    <span class="domain-tag" id="domainTag">Architecture</span>
                </div>
                <div class="question-text" id="questionText">
                    Click "Start Quiz" to begin your SnowPro Core certification practice!
                </div>
                <div class="options" id="optionsContainer"></div>
                <div class="card-actions" id="cardActions"></div>
                <div class="explanation hidden" id="explanation"></div>
            </div>
        </div>
    </div>

    <script>
        // Quiz data based on the SnowPro Core certification notes
        const questions = [
            // Domain 1: Architecture
            {
                domain: 'architecture',
                type: 'multiple',
                question: 'What are the three layers of Snowflake\'s architecture?',
                options: [
                    'Storage, Compute, and Cloud Services',
                    'Database, Warehouse, and Application',
                    'ETL, Storage, and Analytics',
                    'Staging, Processing, and Output'
                ],
                correct: 0,
                explanation: 'Snowflake uses a 3-tier architecture consisting of: Storage Layer (compressed micro-partitions), Query Processing Layer (virtual warehouses), and Cloud Services Layer (authentication, metadata management, query optimization).'
            },
            {
                domain: 'architecture',
                type: 'true_false',
                question: 'Snowflake charges based on a pay-as-you-go consumption model.',
                correct: true,
                explanation: 'Yes, Snowflake uses a consumption-based pricing model where you only pay for the compute and storage resources you actually use.'
            },
            {
                domain: 'architecture',
                type: 'multiple',
                question: 'What is the size range of Snowflake micro-partitions when uncompressed?',
                options: [
                    '10-100 MB',
                    '50-500 MB',
                    '100-1000 MB',
                    '1-10 GB'
                ],
                correct: 1,
                explanation: 'Micro-partitions are 50-500 MB when uncompressed, but they are stored in a compressed format making them even smaller in actual storage.'
            },
            {
                domain: 'architecture',
                type: 'multiple',
                question: 'Which Snowflake edition supports up to 90 days of time travel?',
                options: [
                    'Standard',
                    'Enterprise',
                    'Business Critical',
                    'Virtual Private Snowflake'
                ],
                correct: 1,
                explanation: 'Enterprise edition and higher support up to 90 days of time travel, while Standard edition only supports 1 day.'
            },
            {
                domain: 'architecture',
                type: 'multiple',
                question: 'What are the three types of table stages in Snowflake?',
                options: [
                    'User, Table, and Named stages',
                    'Internal, External, and Temporary stages',
                    'Private, Public, and Shared stages',
                    'Local, Remote, and Cloud stages'
                ],
                correct: 0,
                explanation: 'Snowflake has three types of internal stages: User stage (@~), Table stage (@%), and Named stage (@).'
            },

            // Domain 2: Security
            {
                domain: 'security',
                type: 'multiple',
                question: 'Which role is the most powerful in Snowflake and should be used sparingly?',
                options: [
                    'SYSADMIN',
                    'SECURITYADMIN',
                    'ACCOUNTADMIN',
                    'USERADMIN'
                ],
                correct: 2,
                explanation: 'ACCOUNTADMIN is the most powerful role that can view billing information and administers the entire Snowflake account. It should be limited to minimum users with MFA enabled.'
            },
            {
                domain: 'security',
                type: 'true_false',
                question: 'Multi-factor authentication (MFA) is enabled by default in Snowflake.',
                correct: false,
                explanation: 'MFA is not enabled by default. Users must self-enroll through their user preferences in the web interface.'
            },
            {
                domain: 'security',
                type: 'multiple',
                question: 'What is the purpose of Dynamic Data Masking in Snowflake?',
                options: [
                    'To encrypt data at rest',
                    'To hide sensitive data from unauthorized users at query time',
                    'To compress data for storage efficiency',
                    'To replicate data across regions'
                ],
                correct: 1,
                explanation: 'Dynamic Data Masking uses masking policies to obfuscate sensitive data at execution time, protecting it from unauthorized users without changing the actual stored data.'
            },
            {
                domain: 'security',
                type: 'multiple',
                question: 'Which security feature allows you to control data access at the individual row level?',
                options: [
                    'Column-level security',
                    'Row-level security (Row Access Policies)',
                    'Object tagging',
                    'Secure views'
                ],
                correct: 1,
                explanation: 'Row-level security is implemented using row access policies that allow you to control which rows a user or role can see when querying data.'
            },
            {
                domain: 'security',
                type: 'true_false',
                question: 'Data in Snowflake is always encrypted at rest and in transit by default.',
                correct: true,
                explanation: 'Yes, Snowflake always encrypts data at rest and in transit by default. This cannot be turned off and provides comprehensive data protection.'
            },

            // Domain 3: Performance
            {
                domain: 'performance',
                type: 'multiple',
                question: 'How many credits per hour does an X-Large virtual warehouse consume?',
                options: [
                    '8 credits',
                    '16 credits',
                    '32 credits',
                    '64 credits'
                ],
                correct: 1,
                explanation: 'X-Large warehouses consume 16 credits per hour. The pattern doubles: X-Small(1), Small(2), Medium(4), Large(8), X-Large(16), 2X-Large(32), etc.'
            },
            {
                domain: 'performance',
                type: 'true_false',
                question: 'When a virtual warehouse is suspended, it still consumes credits.',
                correct: false,
                explanation: 'No, suspended warehouses do not consume credits. You only pay for compute when the warehouse is actively running queries.'
            },
            {
                domain: 'performance',
                type: 'multiple',
                question: 'What is the default auto-suspend time for virtual warehouses?',
                options: [
                    '1 minute',
                    '5 minutes',
                    '10 minutes',
                    '15 minutes'
                ],
                correct: 1,
                explanation: 'The default auto-suspend time is 5 minutes of inactivity. This helps optimize costs by automatically suspending idle warehouses.'
            },
            {
                domain: 'performance',
                type: 'multiple',
                question: 'Which type of cache is specific to a virtual warehouse and stored on SSD?',
                options: [
                    'Metadata cache',
                    'Result cache',
                    'Local disk cache',
                    'Query cache'
                ],
                correct: 2,
                explanation: 'Local disk cache is tied to a specific virtual warehouse\'s SSD storage and caches data from previous queries to improve performance for subsequent similar queries.'
            },
            {
                domain: 'performance',
                type: 'multiple',
                question: 'What does "data spilling to remote storage" indicate?',
                options: [
                    'Good query performance',
                    'Efficient memory usage',
                    'Warehouse memory is insufficient for the workload',
                    'Normal query processing'
                ],
                correct: 2,
                explanation: 'Data spilling to remote storage indicates that the warehouse doesn\'t have enough memory to process the query, forcing it to use slower disk storage, which significantly impacts performance.'
            },

            // Domain 4: Data Loading
            {
                domain: 'loading',
                type: 'multiple',
                question: 'What is the recommended file size for optimal data loading performance?',
                options: [
                    '10-50 MB',
                    '100-250 MB or larger (compressed)',
                    '500 MB - 1 GB',
                    'Over 5 GB'
                ],
                correct: 1,
                explanation: 'Snowflake recommends loading files of 100-250 MB or larger (compressed) for optimal performance, as this allows better distribution across compute resources.'
            },
            {
                domain: 'loading',
                type: 'true_false',
                question: 'Snowpipe requires a user-defined virtual warehouse to load data.',
                correct: false,
                explanation: 'False. Snowpipe uses serverless compute resources managed by Snowflake, eliminating the need for user-defined virtual warehouses.'
            },
            {
                domain: 'loading',
                type: 'multiple',
                question: 'Which command is used to stage files from a local machine to an internal stage?',
                options: [
                    'COPY INTO',
                    'PUT',
                    'GET',
                    'LOAD'
                ],
                correct: 1,
                explanation: 'The PUT command is used to upload files from a local machine to an internal stage before loading them into tables.'
            },
            {
                domain: 'loading',
                type: 'multiple',
                question: 'What is the default error handling behavior for bulk loading with COPY INTO?',
                options: [
                    'CONTINUE',
                    'SKIP_FILE',
                    'ABORT_STATEMENT',
                    'IGNORE_ERRORS'
                ],
                correct: 2,
                explanation: 'The default for bulk loading is ABORT_STATEMENT, which stops the entire load process if any errors are found. Snowpipe defaults to SKIP_FILE.'
            },
            {
                domain: 'loading',
                type: 'multiple',
                question: 'How long is load metadata stored for each table in Snowflake?',
                options: [
                    '7 days',
                    '14 days',
                    '30 days',
                    '64 days'
                ],
                correct: 3,
                explanation: 'Load metadata is stored for 64 days, allowing you to track and manage data loading history and prevent duplicate loads.'
            },

            // Domain 5: Data Transformations
            {
                domain: 'transformation',
                type: 'multiple',
                question: 'What is the maximum size of a VARIANT column?',
                options: [
                    '8 MB',
                    '16 MB',
                    '32 MB',
                    '64 MB'
                ],
                correct: 1,
                explanation: 'The maximum length of a VARIANT column is 16 MB, which is used to store semi-structured data like JSON, AVRO, Parquet, ORC, and XML.'
            },
            {
                domain: 'transformation',
                type: 'multiple',
                question: 'Which algorithm does Snowflake use for cardinality estimation?',
                options: [
                    'MinHash',
                    'HyperLogLog',
                    'Space-Saving',
                    't-Digest'
                ],
                correct: 1,
                explanation: 'Snowflake uses HyperLogLog algorithm for cardinality estimation, which can determine unique counts at a fraction of the cost with high accuracy.'
            },
            {
                domain: 'transformation',
                type: 'true_false',
                question: 'User-defined functions (UDFs) in Snowflake can be written in Python, Java, JavaScript, and SQL.',
                correct: true,
                explanation: 'Yes, Snowflake supports UDFs in all four languages: Python, Java, JavaScript, and SQL, allowing flexibility in function development.'
            },
            {
                domain: 'transformation',
                type: 'multiple',
                question: 'Which function is used to convert semi-structured data to relational format?',
                options: [
                    'PARSE_JSON',
                    'TO_JSON',
                    'FLATTEN',
                    'OBJECT_CONSTRUCT'
                ],
                correct: 2,
                explanation: 'FLATTEN is a table function that converts semi-structured data (variant, object, or array) to a relational representation.'
            },
            {
                domain: 'transformation',
                type: 'multiple',
                question: 'What are the two types of UDFs available in Snowflake?',
                options: [
                    'Simple and Complex functions',
                    'Scalar and Table functions',
                    'Inline and Stored functions',
                    'Public and Private functions'
                ],
                correct: 1,
                explanation: 'Snowflake supports Scalar functions (return one output row per input row) and Table functions (return zero, one, or many rows per input row).'
            },

            // Domain 6: Data Protection
            {
                domain: 'protection',
                type: 'multiple',
                question: 'What is the maximum time travel retention period for permanent objects in Enterprise edition?',
                options: [
                    '1 day',
                    '7 days',
                    '30 days',
                    '90 days'
                ],
                correct: 3,
                explanation: 'Enterprise edition and higher support up to 90 days of time travel for permanent objects, while Standard edition is limited to 1 day.'
            },
            {
                domain: 'protection',
                type: 'true_false',
                question: 'Cloning in Snowflake involves physical copying of data.',
                correct: false,
                explanation: 'False. Cloning is a zero-copy operation that creates metadata pointers to the original data, not physical copies. Storage costs only occur when data changes.'
            },
            {
                domain: 'protection',
                type: 'multiple',
                question: 'How long is the fail-safe period for permanent objects?',
                options: [
                    '1 day',
                    '7 days (non-configurable)',
                    '14 days',
                    '30 days'
                ],
                correct: 1,
                explanation: 'Fail-safe provides a non-configurable 7-day period after time travel expires, accessible only by Snowflake employees for data recovery in extreme cases.'
            },
            {
                domain: 'protection',
                type: 'true_false',
                question: 'Transient and temporary tables have a fail-safe period.',
                correct: false,
                explanation: 'False. Transient and temporary tables do not have a fail-safe period, which reduces storage costs but provides less data protection.'
            },
            {
                domain: 'protection',
                type: 'multiple',
                question: 'Which objects can be cloned in Snowflake?',
                options: [
                    'Only tables and views',
                    'Databases, schemas, tables, streams, stages, and sequences',
                    'All database objects without exception',
                    'Only permanent objects'
                ],
                correct: 1,
                explanation: 'You can clone databases, schemas, tables, streams, external named stages, file formats, sequences, tasks, and pipes. Internal stages and views cannot be cloned directly.'
            },

            // Additional Mixed Questions
            {
                domain: 'architecture',
                type: 'multiple',
                question: 'What does SaaS stand for in the context of Snowflake?',
                options: [
                    'Storage as a Service',
                    'Software as a Service',
                    'Security as a Service',
                    'Scaling as a Service'
                ],
                correct: 1,
                explanation: 'Snowflake is delivered as Software as a Service (SaaS), meaning the vendor manages the infrastructure while customers manage their data and usage.'
            },
            {
                domain: 'security',
                type: 'multiple',
                question: 'Which role can create resource monitors?',
                options: [
                    'SYSADMIN',
                    'SECURITYADMIN',
                    'ACCOUNTADMIN',
                    'USERADMIN'
                ],
                correct: 2,
                explanation: 'Only the ACCOUNTADMIN role can create resource monitors to control credit usage and prevent unexpected billing charges.'
            },
            {
                domain: 'performance',
                type: 'true_false',
                question: 'Query pruning helps reduce the number of micro-partitions scanned during query execution.',
                correct: true,
                explanation: 'Yes, query pruning uses metadata to identify and scan only the micro-partitions that contain relevant data, significantly improving query performance.'
            },
            {
                domain: 'loading',
                type: 'multiple',
                question: 'Which file formats does Snowflake support for loading semi-structured data?',
                options: [
                    'JSON, XML, CSV',
                    'JSON, AVRO, ORC, Parquet, XML',
                    'JSON, XML, YAML',
                    'Only JSON and XML'
                ],
                correct: 1,
                explanation: 'Snowflake supports JSON, AVRO, ORC, Parquet, and XML for semi-structured data loading and processing.'
            },
            {
                domain: 'transformation',
                type: 'true_false',
                question: 'Directory tables are separate database objects that must be created manually.',
                correct: false,
                explanation: 'False. Directory tables are implicit objects layered on stages that catalog staged files. They are not separate database objects and are enabled when creating a stage.'
            },
            {
                domain: 'protection',
                type: 'multiple',
                question: 'What command is used to restore a dropped object in Snowflake?',
                options: [
                    'RESTORE',
                    'RECOVER',
                    'UNDROP',
                    'ROLLBACK'
                ],
                correct: 2,
                explanation: 'The UNDROP command is used to restore dropped objects within the time travel retention period.'
            },

            // Advanced Questions
            {
                domain: 'architecture',
                type: 'multiple',
                question: 'What is the clustering key used for in Snowflake?',
                options: [
                    'Encrypting data in micro-partitions',
                    'Co-locating related data in the same micro-partitions',
                    'Compressing data for storage',
                    'Replicating data across regions'
                ],
                correct: 1,
                explanation: 'A clustering key is used to co-locate related data in the same micro-partitions, improving query performance by reducing the number of partitions that need to be scanned.'
            },
            {
                domain: 'security',
                type: 'multiple',
                question: 'What is the difference between Account Usage and Information Schema views?',
                options: [
                    'No difference, they are identical',
                    'Account Usage includes dropped objects and has higher latency',
                    'Information Schema is more comprehensive',
                    'Account Usage is only for admin roles'
                ],
                correct: 1,
                explanation: 'Account Usage views include dropped objects, have 45 minutes to 3 hours latency, and retain 1 year of data. Information Schema has zero latency but only 7 days to 6 months retention and excludes dropped objects.'
            },
            {
                domain: 'performance',
                type: 'multiple',
                question: 'What is the maximum number of clusters in a multi-cluster warehouse?',
                options: [
                    '5',
                    '8',
                    '10',
                    '16'
                ],
                correct: 2,
                explanation: 'The maximum number of clusters in a multi-cluster warehouse is 10, allowing for high concurrency workloads.'
            },
            {
                domain: 'loading',
                type: 'true_false',
                question: 'If you attempt to load the same file twice, Snowflake will load it again by default.',
                correct: false,
                explanation: 'False. Snowflake automatically prevents loading the same file multiple times by maintaining load metadata for 64 days.'
            },
            {
                domain: 'transformation',
                type: 'multiple',
                question: 'Which system function checks if a stream has data to be processed?',
                options: [
                    'STREAM_HAS_DATA()',
                    'SYSTEM$STREAM_HAS_DATA()',
                    'CHECK_STREAM_DATA()',
                    'HAS_STREAM_DATA()'
                ],
                correct: 1,
                explanation: 'SYSTEM$STREAM_HAS_DATA() is the system function used to check if a stream contains records to be processed, typically used in task scheduling.'
            },
            {
                domain: 'protection',
                type: 'multiple',
                question: 'What happens to unconsumed records in a stream when you clone it?',
                options: [
                    'They are copied to the cloned stream',
                    'They are not available in the clone - stream starts fresh',
                    'They are duplicated in both streams',
                    'The clone operation fails'
                ],
                correct: 1,
                explanation: 'When cloning a stream, unconsumed records are not available in the clone. The cloned stream begins tracking changes from the point of creation.'
            },

            // More Domain-Specific Questions
            {
                domain: 'architecture',
                type: 'true_false',
                question: 'Snowflake can run on AWS, Azure, and Google Cloud Platform.',
                correct: true,
                explanation: 'Yes, Snowflake is a cloud-agnostic platform that runs on all three major cloud providers: AWS, Microsoft Azure, and Google Cloud Platform.'
            },
            {
                domain: 'security',
                type: 'multiple',
                question: 'What is required to use federated authentication in Snowflake?',
                options: [
                    'Multi-factor authentication',
                    'An external identity provider (IdP)',
                    'Business Critical edition',
                    'Custom encryption keys'
                ],
                correct: 1,
                explanation: 'Federated authentication requires an external identity provider (IdP) like Okta to handle user authentication outside of Snowflake.'
            },
            {
                domain: 'performance',
                type: 'multiple',
                question: 'What does Query Acceleration Service (QAS) help with?',
                options: [
                    'Reducing storage costs',
                    'Handling unpredictable workloads with mixed query types',
                    'Improving data loading speed',
                    'Encrypting queries'
                ],
                correct: 1,
                explanation: 'QAS helps with unpredictable workloads by automatically provisioning additional resources for large table scans while allowing smaller queries to use base warehouse resources efficiently.'
            },
            {
                domain: 'loading',
                type: 'multiple',
                question: 'What is the minimum interval recommended for staging files with Snowpipe?',
                options: [
                    '30 seconds',
                    '1 minute',
                    '5 minutes',
                    '15 minutes'
                ],
                correct: 1,
                explanation: 'Snowflake recommends staging files at minimum one-minute intervals for optimal Snowpipe performance and efficiency.'
            },
            {
                domain: 'transformation',
                type: 'true_false',
                question: 'Materialized views in Snowflake can contain joins and user-defined functions.',
                correct: false,
                explanation: 'False. Materialized views have significant limitations - they cannot contain joins, user-defined functions, or window functions.'
            },
            {
                domain: 'protection',
                type: 'multiple',
                question: 'Which type of share allows you to create a data hub for selected members?',
                options: [
                    'Public share',
                    'Secure share',
                    'Private Data Exchange',
                    'Data Marketplace'
                ],
                correct: 2,
                explanation: 'Private Data Exchange allows creating an exclusive data hub for collaboration between selected invited members, unlike the public Data Marketplace.'
            },

            // Final Advanced Questions
            {
                domain: 'architecture',
                type: 'multiple',
                question: 'What prefix is used to reference a named internal stage?',
                options: [
                    '@~',
                    '@%',
                    '@',
                    '@#'
                ],
                correct: 2,
                explanation: 'Named internal stages use the @ prefix, while user stages use @~ and table stages use @%.'
            },
            {
                domain: 'security',
                type: 'true_false',
                question: 'Secure views provide better performance than regular views.',
                correct: false,
                explanation: 'False. Secure views have worse performance than regular views because the query optimizer bypasses some optimizations to maintain security.'
            },
            {
                domain: 'performance',
                type: 'multiple',
                question: 'Which cache serves the entire Snowflake environment and is not warehouse-specific?',
                options: [
                    'Local disk cache',
                    'Result cache',
                    'Metadata cache',
                    'Query cache'
                ],
                correct: 1,
                explanation: 'Result cache stores query results for 24 hours and serves the entire environment - any user with proper privileges can benefit from cached results regardless of warehouse.'
            },
            {
                domain: 'loading',
                type: 'multiple',
                question: 'What does the VALIDATION_MODE option do in COPY INTO?',
                options: [
                    'Loads data with validation',
                    'Checks file validity without loading data',
                    'Validates user permissions',
                    'Validates warehouse capacity'
                ],
                correct: 1,
                explanation: 'VALIDATION_MODE allows you to check the validity of a COPY INTO command and identify potential issues without actually loading the data.'
            },
            {
                domain: 'transformation',
                type: 'multiple',
                question: 'What is the Space-Saving algorithm used for in Snowflake?',
                options: [
                    'Data compression',
                    'Frequency estimation',
                    'Storage optimization',
                    'Query optimization'
                ],
                correct: 1,
                explanation: 'The Space-Saving algorithm is used for frequency estimation, providing a space and time-efficient way to estimate approximate frequent values in datasets.'
            },
            {
                domain: 'protection',
                type: 'true_false',
                question: 'Data sharing in Snowflake involves physical data movement between accounts.',
                correct: false,
                explanation: 'False. Snowflake data sharing provides zero-latency access to shared data without physical movement or duplication, using metadata-based sharing.'
            }
        ];

        // Quiz state
        let currentQuestionIndex = 0;
        let correctAnswers = 0;
        let totalAnswered = 0;
        let selectedFilter = 'all';
        let filteredQuestions = [...questions];
        let userAnswers = [];
        let showingExplanation = false;
        let quizStarted = false;

        // DOM elements
        const questionCard = document.getElementById('questionCard');
        const questionNumber = document.getElementById('questionNumber');
        const domainTag = document.getElementById('domainTag');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const cardActions = document.getElementById('cardActions');
        const explanation = document.getElementById('explanation');
        const currentQuestionSpan = document.getElementById('currentQuestion');
        const totalQuestionsSpan = document.getElementById('totalQuestions');
        const correctAnswersSpan = document.getElementById('correctAnswers');
        const accuracySpan = document.getElementById('accuracy');
        const progressFill = document.getElementById('progressFill');

        function startQuiz() {
            quizStarted = true;
            currentQuestionIndex = 0;
            correctAnswers = 0;
            totalAnswered = 0;
            userAnswers = [];
            showingExplanation = false;
            applyFilter();
            displayQuestion();
            updateStats();
        }

        function filterDomain(domain) {
            selectedFilter = domain;
            
            // Update active button
            document.querySelectorAll('.domain-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (quizStarted) {
                applyFilter();
                currentQuestionIndex = 0;
                displayQuestion();
                updateStats();
            }
        }

        function applyFilter() {
            if (selectedFilter === 'all') {
                filteredQuestions = [...questions];
            } else {
                filteredQuestions = questions.filter(q => q.domain === selectedFilter);
            }
        }

        function shuffleQuestions() {
            for (let i = filteredQuestions.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [filteredQuestions[i], filteredQuestions[j]] = [filteredQuestions[j], filteredQuestions[i]];
            }
            if (quizStarted) {
                currentQuestionIndex = 0;
                displayQuestion();
                updateStats();
            }
        }

        function resetQuiz() {
            currentQuestionIndex = 0;
            correctAnswers = 0;
            totalAnswered = 0;
            userAnswers = [];
            showingExplanation = false;
            quizStarted = false;
            
            questionText.textContent = "Click 'Start Quiz' to begin your SnowPro Core certification practice!";
            optionsContainer.innerHTML = '';
            cardActions.innerHTML = '';
            explanation.classList.add('hidden');
            
            updateStats();
        }

        function displayQuestion() {
            if (currentQuestionIndex >= filteredQuestions.length) {
                showCompletion();
                return;
            }

            const question = filteredQuestions[currentQuestionIndex];
            showingExplanation = false;
            
            questionNumber.textContent = `Question ${currentQuestionIndex + 1}`;
            domainTag.textContent = capitalizeFirst(question.domain);
            domainTag.className = `domain-tag domain-${question.domain}`;
            questionText.textContent = question.question;
            
            // Clear previous content
            optionsContainer.innerHTML = '';
            cardActions.innerHTML = '';
            explanation.classList.add('hidden');
            
            if (question.type === 'multiple') {
                question.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'option';
                    optionDiv.textContent = option;
                    optionDiv.onclick = () => selectOption(index);
                    optionsContainer.appendChild(optionDiv);
                });
            } else if (question.type === 'true_false') {
                ['True', 'False'].forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'option';
                    optionDiv.textContent = option;
                    optionDiv.onclick = () => selectOption(index === 0);
                    optionsContainer.appendChild(optionDiv);
                });
            }
            
            // Add action buttons
            const submitBtn = document.createElement('button');
            submitBtn.className = 'btn btn-primary';
            submitBtn.textContent = 'Submit Answer';
            submitBtn.id = 'submitBtn';
            submitBtn.onclick = submitAnswer;
            submitBtn.disabled = true;
            
            cardActions.appendChild(submitBtn);
        }

        function selectOption(selectedValue) {
            // Remove previous selections
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            
            // Mark current selection
            if (typeof selectedValue === 'number') {
                document.querySelectorAll('.option')[selectedValue].classList.add('selected');
            } else {
                // For true/false questions
                const index = selectedValue ? 0 : 1;
                document.querySelectorAll('.option')[index].classList.add('selected');
            }
            
            // Store the answer
            userAnswers[currentQuestionIndex] = selectedValue;
            
            // Enable submit button
            document.getElementById('submitBtn').disabled = false;
        }

        function submitAnswer() {
            if (showingExplanation) {
                nextQuestion();
                return;
            }
            
            const question = filteredQuestions[currentQuestionIndex];
            const userAnswer = userAnswers[currentQuestionIndex];
            const isCorrect = userAnswer === question.correct;
            
            if (isCorrect) {
                correctAnswers++;
            }
            totalAnswered++;
            
            // Show correct/incorrect styling
            document.querySelectorAll('.option').forEach((opt, index) => {
                if (question.type === 'multiple') {
                    if (index === question.correct) {
                        opt.classList.add('correct');
                    } else if (index === userAnswer && !isCorrect) {
                        opt.classList.add('incorrect');
                    }
                } else {
                    const isTrue = index === 0;
                    if (isTrue === question.correct) {
                        opt.classList.add('correct');
                    } else if (isTrue === userAnswer && !isCorrect) {
                        opt.classList.add('incorrect');
                    }
                }
            });
            
            // Show explanation
            explanation.innerHTML = `
                <h4>Explanation:</h4>
                <p>${question.explanation}</p>
            `;
            explanation.classList.remove('hidden');
            
            // Update button
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.textContent = 'Next Question';
            submitBtn.className = 'btn btn-success';
            
            showingExplanation = true;
            updateStats();
        }

        function nextQuestion() {
            currentQuestionIndex++;
            displayQuestion();
            updateStats();
        }

        function updateStats() {
            currentQuestionSpan.textContent = Math.min(currentQuestionIndex + 1, filteredQuestions.length);
            totalQuestionsSpan.textContent = filteredQuestions.length;
            correctAnswersSpan.textContent = correctAnswers;
            
            const accuracy = totalAnswered > 0 ? Math.round((correctAnswers / totalAnswered) * 100) : 0;
            accuracySpan.textContent = `${accuracy}%`;
            
            const progress = filteredQuestions.length > 0 ? (currentQuestionIndex / filteredQuestions.length) * 100 : 0;
            progressFill.style.width = `${Math.min(progress, 100)}%`;
        }

        function showCompletion() {
            const accuracy = Math.round((correctAnswers / totalAnswered) * 100);
            const grade = accuracy >= 80 ? 'Excellent!' : accuracy >= 70 ? 'Good Job!' : accuracy >= 60 ? 'Keep Studying!' : 'Need More Practice';
            
            questionCard.innerHTML = `
                <div class="completion-screen">
                    <h2>🎉 Quiz Complete!</h2>
                    <h3>${grade}</h3>
                    <div class="completion-stats">
                        <div class="completion-stat">
                            <div class="stat-number">${correctAnswers}/${totalAnswered}</div>
                            <div class="stat-label">Correct Answers</div>
                        </div>
                        <div class="completion-stat">
                            <div class="stat-number">${accuracy}%</div>
                            <div class="stat-label">Final Score</div>
                        </div>
                        <div class="completion-stat">
                            <div class="stat-number">${filteredQuestions.length}</div>
                            <div class="stat-label">Total Questions</div>
                        </div>
                        <div class="completion-stat">
                            <div class="stat-number">${selectedFilter === 'all' ? 'All' : capitalizeFirst(selectedFilter)}</div>
                            <div class="stat-label">Domain(s)</div>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="btn btn-primary" onclick="startQuiz()">Retake Quiz</button>
                        <button class="btn btn-secondary" onclick="resetQuiz()">Back to Start</button>
                    </div>
                </div>
            `;
        }

        function capitalizeFirst(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        // Initialize
        updateStats();
    </script>
</body>
</html>